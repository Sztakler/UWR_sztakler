<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<title>Wykład 4 -- Routing (wewnątrz routera)</title>
	<meta name='Generator' content='Zim 0.74.3'>
	<style type='text/css'>
		a          { text-decoration: none      }
		a:hover    { text-decoration: underline }
		a:active   { text-decoration: underline }
		strike     { color: grey                }
		u          { text-decoration: none;
					 background-color: yellow   }
		tt         { color: #2e3436;            }
		pre        { color: #2e3436;
					 margin-left: 20px          }
		h1         { text-decoration: underline;
					 color: #4e9a06; margin-bottom: 0 }
		h2         { color: #4e9a06; margin-bottom: 0 }
		h3         { color: #4e9a06; margin-bottom: 0 }
		h4         { color: #4e9a06; margin-bottom: 0 }
		h5         { color: #4e9a06; margin-bottom: 0 }
		p          { margin-top: 0              }
		span.zim-tag {
			color: #ce5c00;
		}
		div.zim-object {
			border-style:solid;
			border-width:1px;
		}
		.checked-box {list-style-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAANOgAADMQBiN+4gQAAAAd0SU1FB9gKGQ8sMEGsKGkAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAEBUlEQVRIx62V22tdRRTGf7Nn73P2ybntnNOe3NqkPTGgLTVUUZF6QatSLOKTPgqCIqLgQ0H/A1sQQbBYCBb1QfAxiC8tSO1FqHkwJVKtjdTGNraUmObsc9nXmfGh7cGYpM1D5nHWzPetteZb3wg2eB2YqYm4zSadsMtoboiNBH/3TE0awx6j+MRoxoTg/IYRvP19TQrJS0bzhdHGSyKFkLTtjSKwMjyiEz43ynhtP6bdjBCWyFobAf7eT7VhNF/q1FRbjYjmUohlCVPwnB+6FUxMTJipqSmUUhhjEGKd3bMT4ks/Y6oLBK2Yth8hHYtCJXOix7Nf7xLMzc0xOzvLzp078TyPNE3viW3QJPXzhNWbxFFKHCmMhoLn/FHodd48vGfhapdAacXQlkFK5dL6wIUm6fuTZPuvqDQhaMUYYyiVyuQr6rXDexYuAdi3tSv1ZJNs/R/CaszzT+1na88uXFnCEnJVgivBNN8uTJKmHQI/ptOOcXNZzMz9mOqFs90OHpipWcYwlo5P4ebnuOkrvr5wgrH+h3im7y36MzuwRXYZeKha/OhP0EkadFoxQSdGSotedR/+XwMc2XvKdNUFOFqZx6LKZWIiwjgkikNmLp/hm8sH+K1zjFTHXfBYdTi+eJArzXM0GxFxoBDCopLvo/fqEwi1XPkWkGqjFo2TgB1jOYZUKZTS/D1/ncmLh7jon0IbRWoiTi59ymzzJEEQE3cStNZsGxqlfPE57MBbOR8fP3hDGalOO9fq2DlBvmZw8xa2IxACGn6TydlD/O6f5OzSV/zif0cYhLQaEXGkKBbz7Ov/AOlXV1cxgBJRI3fuSTrpTawt18kWIZN1CFuaONI0w0WOXfsI43YIggh/KUSlhqxrMz74AkOZcWBm9QkH+Gw8NDLuITi+m0yzhluSyJzBLcpblUhFxywSRAEtPwQjsKVN30CNh0uvYuOubSHLtN3J0TO1j0pmBNuFbFWRK0gyPRZpktL2I5JQkclKakNlnh54g6ocvevUr/Ai2a7wineEkcJupA3S1Wg0nVZM2E6wbEF5U5G9Q++wI7sfR7h3N8HVNstykBfzH+KJEZwiWD0aIwxCgJ0R1Mu7GXOeJSuK93bZtQIle4D9pUNU5DC5jEsu55AvZakM5NicGyEj8uuz8bUCQgj67QfY671P3vEoeC69gy695U1U7NG7XV0pUwBjDJa1/JJlWWxzHuflzQe5FJ/GsgUVuZ2t8lEkTvfc0aNHb72flBhjVicQQqCUuvM3/M+WDVguWBrMVdDXEGZlBVEUrVCU9d9s5+fnaTQa2PZyPxEIhJaI1EEoZwX4ncynp6fXrmB4eJjR0VFarRbNZnP9P9rt9gohqNVq1Ov1ZbF/AZGev3hLJ2/zAAAAAElFTkSuQmCC)}
		.xchecked-box {list-style-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAANOgAADMQBiN+4gQAAAAd0SU1FB9gKGQ8bDYnDxEwAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAEK0lEQVRIx9WVS2hTWRjHf/eR3CY1nbxMH2YiZRQS6qO13YlMVxY3SnVcuNIBFezGpSADLoQqLu1sHJCqdCFSXFpw4YOCSH3BtFqttTNamabX3DS5bfO6uffMoglja3RGcDMHzuac7/z/53++//cd+L8P6VuCPQYZ8ADNgBd4J31DcDcQs+GnHByRocEDv0kfBSjAOlYCs11Q+gpwDegS8LMJ+3QIK0ATzEhV8Odnz5bzw8P4dJ25aJQ/WlvJ1df/K7hSLtOcTNI+Pk69rpMTgqIQhCDvh1/VSpw79+gRrRMTmLZNezLJJsPg+a5dmOEwQlFqg1sWG16/Jv7sGWXDwBACFQjC9HcwIMONKkGp4PGAJGEDS0IQmZlhnWnye3c3eiyGo6qr3WHbrJ+dJf7gAXI6zSIr72T7/fgzmT4FHnTBsgrQBfYvTU0km5vxz86iADnAm0rRPTWFt7cXZccOJJcLAGHb2K9ekT93jmwmwwdAAFpjI6Ntbfxw5879ag7l6o1sr5eHHR3IsRgeQK/M4sQE+YEB7JcvEY6zAj45SWFgAPPxYwzHoQxIkQjTPT0kIxE+Noj8sexFn4/xnh58iQTeSpHkHAdrbIzi0BCOrmNPTpK/eJHM3bt8sCyKQCiR4NWePWSiUZw1+ZLXJm4pFKLhzBlCsRh2RUXacVgeGaF47RrL58+zcP8+RrmMkCQinZ1EL1zAjERqmkH+tLYl1G3bCJw4QUjT0IA0MJfLMX/5MqmHD0nZNiUgtGULG/r7ccXjINWuWbnmqsuFu7sb/4EDNLlcBIEioNs2KUAFGmMxmk6dQm1tRZI+3xBqEkiShBQOox05Ql1nJ26gvuIUAWiKQnj/ftStW5Fk+YuF+NldsbBA4cYN9KdPmaso8Fc62ZJtk7l1C2t0FGdxESHE1xE4hkHh6lX0oSHSpRIewC/LrPf7CSgKNpCamkI/fZr8pUuIZBIcpyaBunahPp1mub+fDyMjGKUSChCsq6Nh717q9u2jbnSU0uAgRrFIwTThyhUCqRS+hgZKLS1fJvDm87SNjZGcnsYUAjcQ8vsJ9/Xh7u1FDgRQN20iks3iDA+zZFmYhQLqzZtsj8WY3L0baY2Sf55ICCKpFHUzM2SEQAJCHg+hY8fQDh5EDgRWDoRC1J88SePRo2geD0XAcBy8b98Sv3ePYDZbbf2rFQjLIphMsmDbaEBQVQkePox26BCSz7e6i4bDrDt+nGYhmBscpFAskheC4Js3bPR4qHphFYEnlcI7P4/jdqNpGu8TCe4oCsXr1z//F2ga3+/cSfTJE0qmSVYIsKzaOZDcbjKyzFIiwfvt21kMBLA07YsetzWNd+3tLLW0sH5igvT8PH9Go/z44kX+E4LGjg7GDYOcy4XlOEgLC//5P/5LCFzxOPLmzWyIx+m6fduu7v0NVGqyTSycKksAAAAASUVORK5CYII=)}
		.unchecked-box {list-style-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAANOgAADMQBiN+4gQAAAAd0SU1FB9gKGQ8qAt8h3m8AAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAA60lEQVRIx+2VsQqDMBRF70sCLg5OLoKgjk7+lJ/hh+STXBwcnRz8ArMEkrxOFktbaC3tULzTg5e8k5vADXDq70VbobXmvu/hvQczg4heHrJfXxQFuq67blZbMc8zpmlCXddIkgTOuZcBUko45zCOI6y1Nz2xFSEEZFmGOI7fGg4A3nsQEZqmuXOu9jallACAtm3fvmutNaIoAjM/dkBECCF89KCbk4eAb+kEnIAT8EsAM0OIz3hSyrssUvss8t5fg+uIrLXPs0gIgWVZYIyBUurQyYdheO4gz3NUVQVjDNZ1PfSjpWmKsixvehfB9GBZ3NndrgAAAABJRU5ErkJggg==)}
		.migrated-box {list-style-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABGdBTUEAALGPC/xhBQAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAANOgAADMQBiN+4gQAAAAd0SU1FB+AKHREFA8vJSnkAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAC1klEQVRIx+2VT0hUURTGf/e958w4Tc3TYowMw1GyEgwr1MqsFmbZIrIWQZsWJUjbdoHQpl3Qps0swnCRECQFYkR/TC1iKkqmfzAKTo2Vf8hoRsfR995tkRMT87RRWkUHHhy495zvnvvu933wP/75EKkkEAjIYDCIaZpIKRFCZN0kfX9xcTGtra2/irVUEolECIfDlJeXo+s6hmFkDaCqKoZhEAqFSCaTv60pqcSyLAoLC/F4PEtqDmCaJkIIKisrMybX0sdUVRWA5ubmPzdNjjI1cpXkZC/O1fV03PXgdDqRUtpPIITAsqxsDz0Z/3CZQv8uqo4N4C8/Tp2/DdM0MiZQlvk41OTkI/LW1SGtCVb5drD3eCc71wcA+VcAHA5vDd8+3UGakxiJV7i9pdQevU5T1R35pJ3MV5QW1pf+0kWBheJ2SWua8EQXZXsu4fVVYEz1sEKvof5EuxjoPvzpcRvrdp9C2gGMx6cpOHBmbImMesds7BZubwMVDTfXDnQ3vQfK7AC8wLfExMX5whyQc3q2OEnjGm5vE76SQxsfBLr77a7CNf+n0r/l6sSMtsBSnurckiIILCobAtVZhpF4gZF4jubaymj4Ch/fd380LE7bAnjc0NPxk2yqpmEuwGxF0ag+0k5uTpzZeBeaazvj0We8fXojainsb2xh2BZgbe0gSIllzSIUh63wfQ6dZ/O2fbjcKlOj58jJ3cVENESw5yErc9nf2MLQ4jwQAkV1Lqiq37/cZ9WaahJjF9AcmxiPDhLs7ePe23oOnmUwg2hSShQle96tKDjA2HAniusgo9FxnvY9Jxw7RWzGYy92QghM00x5g53qp9sHmtB58/o2umOI2NwGolMnMYUHIb7aAyiKwsjICLqu2/qBEIKUUAohMaSHSLyBSMoPTINQ6CX5+fn2AEVFRZSUlBCPx4nFYhl3L4RESjF/GEgX3pSj+Xw+/H7/b3U/AEOZFnp7O5+5AAAAAElFTkSuQmCC)}
		ul {list-style-image: none}
		/* ul rule needed to reset style for sub-bullets */
	</style>
</head>
<body>

<!-- Header -->
<div class='header'>
	[ <a href='./Wykład_3_--_Routing_(tworzenie_tablic).html'>Prev</a> ]

	[ <span class='insen'>Index</span> ]

	[ <a href='./Wykład_5--_Niższe_warstwy.html'>Next</a> ]
</div>

<hr />

<!-- Wiki content -->

<div class='pages'>
	<div class='heading'>
	<h1>Wykład 4 -- Routing (wewnątrz routera) <a name='Sieci Komputerowe -- Notatki:Wykład 4 -- Routing (wewnątrz routera)'></a></h1>
	</div>

	<div class='content'>
	<p>
Created Tuesday 21 June 2022
</p>

<h2>Zagadnienia<a id="zagadnienia" class="h_anchor"></a></h2>

<br>

<h3>❖ Co to są prywatne adresy IP? Jakie pule adresów są zarezerwowane na takie adresy?<a id="-co-to-są-prywatne-adresy-ip-jakie-pule-adresów-są-zarezerwowane-na-takie-adresy" class="h_anchor"></a></h3>

<p>
Są to adresy przeznaczone dla sieci lokalnych. Pakiety o takich adresach nie są przekazywane przez routery, a same adresy mogą powtarzać się między wieloma sieciami. Ich pule to:<br>
<ul>
<li>10.0.0.0/8 (jedna sieć klasy A)</li>
<li>172.16.0.0/12 (16 sieci klasy B)</li>
<li>192.168.0.0/16 (256 sieci klasy C)</li>
</ul>
</p>

<br>

<h3>❖ Co robi funkcja bind()?<a id="-co-robi-funkcja-bind" class="h_anchor"></a></h3>

<p>
<b>man</b> mówi, że <i>przypisuje nazwę do gniazda</i>, ale nie jest to zbyt wymowna definicja. W przypisaniu nazwy chodzi tak naprawdę o przypisanie adresu sieciowego do danego gniazda. Przypisany adres może pochodzić z różnych rodzin adresów, np. AF_INET (IP), AF_INET6 (ipv6), itd. Przypisany adres jest zapisywany w strukturze <b>sockaddr</b>.
</p>

<h3>❖ Czym różnią się porty o numerach mniejszych niż 1024 od innych?<a id="-czym-różnią-się-porty-o-numerach-mniejszych-niż-1024-od-innych" class="h_anchor"></a></h3>

<p>
Do wiązania z takim portem za pomocą funkcji <b>bind() </b>potrzebne są uprawnienia administratora. Wynika to z faktu, że są to tak zwane <b>well-known ports </b>(<i>dobrze znane porty</i>), które są zarezerwowane do użytku przez system operacyjny i kluczowe usługi. Udostępnienie ich normalnym użytkownikom byłoby naruszeniem bezpieczeństwa.
</p>

<h3>❖ Jakie są zadania procesora routingu, portu wejściowego, portu wyjściowego i struktury przełączającej? (może nie być dobrze)<a id="-jakie-są-zadania-procesora-routingu-portu-wejściowego-portu-wyjściowego-i-struktury-przełączającej-może-nie-być-dobrze" class="h_anchor"></a></h3>

<p>
Router składa się następujących części:
</p>

<p>
<ul>
<li><b>Procesor routingu </b>— otrzymuje niektóre pakiety (RIP, OSPF). Tworzy tablice przekazywania i wysyła je do portów wejściowych.</li>
<li><b>Port wejściowy </b>— odbiera pakiet, uaktualnia nagłówki IP (TTL i checksum), sprawdza do którego portu wyjściowego da się go przesłać.</li>
<li><b>Port wyjściowy </b>— przesyła pakiety dalej w świat. Jeśli pakiety są zbyt duże (większe niż <b>MTU </b>— <i>maximum transmission unit</i>), dzieli je na fragmenty. Szereguje pakiety w buforze wyjściowym, np. względem priorytetów lub cyklicznie (round-robin).</li>
<li><b>Struktura przełączająca </b>--przekazuje pakiety dalej z zadaną (lub przybliżoną) prędkością łącza. Przypomina strukturą sieci Benesa (z AiSDu).</li>
</ul>
</p>

<p>
<img src="./Wykład_4_--_Routing_(wewnątrz_routera)/pasted_image.png">
</p>

<br>
<br>

<h3>❖ Czym się różni przełączanie pakietów w routerze za pomocą RAM od przełączania za pomocą struktury przełączającej?<a id="-czym-się-różni-przełączanie-pakietów-w-routerze-za-pomocą-ram-od-przełączania-za-pomocą-struktury-przełączającej" class="h_anchor"></a></h3>

<p>
We wczesnych generacjach routerów stosowano RAM zamiast struktury przełączającej. Było to  rozwiązanie proste i powolne, oparte na przerwaniach. Struktury przełączające pozwalają na przekazywanie pakietów z prędkością zbliżoną drękości łącza, np. dla N portów wejściowych o prędkości R chcemy przepustowość N*R. 
</p>

<p>
<b>Działanie:</b><br>
<ol type="1" start="1">
<li>Port wejściowy odbiera pakiet i zgłasza przerwanie.</li>
<li>Procesor kopiuje pakiet do RAMu.</li>
<li>Wolny port wyjściowy zgłasza przerwanie.</li>
<li>Procesor kopiuje pakiet z RAMu.</li>
</ol>
</p>

<h3>❖ Jakie są pożądane cechy struktury przełączającej w routerze?<a id="-jakie-są-pożądane-cechy-struktury-przełączającej-w-routerze" class="h_anchor"></a></h3>

<br>

<p>
By przekazywała pakiety z prędkością łącza lub zbliżoną (N portów wejściowych o prędkości R to przepustowość N*R). Chcemy też, by potrafiła bezkolizyjnie i szybko przesłać dowolną permutację.
</p>

<p>
<img src="./Wykład_4_--_Routing_(wewnątrz_routera)/pasted_image001.png">
</p>

<h3>❖ Gdzie w routerze stosuje się buforowanie? Po co?<a id="-gdzie-w-routerze-stosuje-się-buforowanie-po-co" class="h_anchor"></a></h3>

<br>

<p>
Przy <b>portach wyjściowych</b>, gdzie zapobiegają utraci pakietów, przy czasowym zwiększeniu liczby pakietów do wysyłki.<br>
Przy <b>portach wejściowych</b>, gdzie pomagają, gdy przepustowość struktury przełączającej jest zbyt niska, pakiety skierowane do zajętych łącz wyjściowych są blokowane. Pojawia się w nich jednak problem blokowania przodu kolejki:<br>
<img src="./Wykład_4_--_Routing_(wewnątrz_routera)/pasted_image002.png">
</p>

<br>

<h3>❖ Po co w portach wyjściowych klasyfikuje się pakiety?<a id="-po-co-w-portach-wyjściowych-klasyfikuje-się-pakiety" class="h_anchor"></a></h3>

<p>
By zapewnić sprawiedliwy przesył pakietów danego typu. Pakiety dzieli się na strumienie, bazując na określonej metodzie, np. przypisując im priorytety lub stosując round-robin.
</p>

<p>
<img src="./Wykład_4_--_Routing_(wewnątrz_routera)/pasted_image004.png"><br>
<img src="./Wykład_4_--_Routing_(wewnątrz_routera)/pasted_image003.png">
</p>

<h3>❖ Co to jest blokowanie początku kolejki? Gdzie występuje? Jak się go rozwiązuje?<a id="-co-to-jest-blokowanie-początku-kolejki-gdzie-występuje-jak-się-go-rozwiązuje" class="h_anchor"></a></h3>

<p>
<img src="./Wykład_4_--_Routing_(wewnątrz_routera)/pasted_image006.png">
</p>

<p>
Przypomina samochody, które chcą przejechać przez skrzyżowanie. Jeśli jeden samochód chce jechać w lewo, ale nie może, bo ktoś obok niego jedzie prosto, wtedy wszystkie samochody za nim też nie mogą jechać, nawet jeśli chciałyby jechać prosto.<br>
Rozwiązanie to rozdzielić pakiety przed dotarciem do skrzyżowania, zgodnie z tym, gdzie chcą jechać — stworzyć wirtualne kolejki dla portów wyjściowych.
</p>

<h3>❖ Rozwiń skrót LPM.<a id="-rozwiń-skrót-lpm" class="h_anchor"></a></h3>

<p>
<b>LPM </b>— Longest Prefix Match. Mechanizm dopasowywania pakietów do portów zgodnie z adresem (prefiks CIDR).<br>
<img src="./Wykład_4_--_Routing_(wewnątrz_routera)/pasted_image008.png">
</p>

<h3>❖ Jakie znasz struktury danych implementujące LPM? Porównaj je.<a id="-jakie-znasz-struktury-danych-implementujące-lpm-porównaj-je" class="h_anchor"></a></h3>

<p>
<ol type="1" start="1">
<li><b>Lista prefiksów</b>
<ol type="a" start="1">
<li>pamięć: O(n)</li>
<li>lookup: O(n)</li>
<li>insert: O(1)</li>
<li>delete: O(n)</li>
</ol>
</li>
<li><b>Tablice haszujące</b>
<ol type="a" start="1">
<li>w+1 tablic (dla każdej długości prefiksów) — w czasach klas adresów IP wystarczało 5 tablic</li>
<li>pamięć: O(n)</li>
<li>lookup: O(w) (oczekiwany)</li>
<li>insert, delete: O(1) (oczekiwany)</li>
</ol>
</li>
<li><b>Drzewa trie</b>
<ol type="a" start="1">
<li>nowe systemy uniksowe, routery sprzętowe</li>
<li>pamięć: O(n*w) — bo możemy mieć bardzo głęboko jakąś regułkę, i prowadzą do nich ścieżki bez rozgałęzień, kompresja ścieżek bez rozgałęzień daje O(n)</li>
<li>lookup: O(w)</li>
<li>insert, delete: O(w) </li>
</ol></li>
</ol>
<div style='padding-left: 30pt'>
<img src="./Wykład_4_--_Routing_(wewnątrz_routera)/pasted_image010.png">
</div>
</p>

<p>
<div style='padding-left: 30pt'>
W praktyce najlepsze rozwiązanie w softwarze, bo rzeczywiste drzewa maja małą głębokość, a tablice haszujące zmuszają do chodzenia zawsze po w krokach.
</div>
<ol type="1" start="5">
<li><b>Trie z krawędziamy skracającymi</b>
<ol type="a" start="1">
<li>lookup: O(log w)</li>
<li>insert, delete: O(n) w najgorszym przypadku</li>
<li>problem otwarty — czy wszystkie operacje można wykonać w O(log w)?</li>
</ol>
</li>
<li><b>Rozwiązania sprzętowe oparte o TCAM (nowsze routery sprzętowe)</b>
<ol type="a" start="1">
<li><b>TCAM — </b><i>ternary content addressable memory</i></li>
<li>przechowujemy pary (prefix, maska)</li>
<li>dla adresu w można <b>równolegle </b>znaleźć wszystkie takie pary, że w&amp;m = p&amp;m (bitowy and), czyli wszystkie pasujące prefiksy</li>
<li>sprzętowo wybieramy najdłuższy z nich</li>
<li>istotnie szybsze niż rozwiązania softwarowe</li>
</ol></li>
</ol>
</p>

<h3>❖ Co to jest pamięć TCAM? Jak można ją zastosować do implementacji LPM?<a id="-co-to-jest-pamięć-tcam-jak-można-ją-zastosować-do-implementacji-lpm" class="h_anchor"></a></h3>

<p>
<b>TCAM — </b><i>ternary content addressable memory</i>. Rodzaj pamięci wysokiej prędkości, która przeszukuje całą swoją zawartość w jednym cyklu procesora. <i>Ternary </i>w nazwie bierze się stąd, że mamy trzy wartości logiczne — 1, 0 oraz X (don't care). Jest przeciwieństwem pamięci RAM, bo tam gdzie RAM potrzebuje adresu, by znaleźć zawartość, tam CAM potrafi wyszukiwać po zawartości.
</p>

<p>
Pamięć tę można wykorzystać do implementacji <b>LPM</b>, tworząc w niej pary (prefix, maska), a następnie możemy równolegle odnajdywać w niej wszystkie pary takie, że sieć &amp; maska = prefix &amp; maska, co daje nam wszystkie pasujące prefiksy. Wystarczy wtedy wybrać najdłuższy z nich.
</p>

<h3>❖ Na czym polega fragmentacja IP? Gdzie się ją stosuje i dlaczego? Gdzie łączy się fragmenty?<a id="-na-czym-polega-fragmentacja-ip-gdzie-się-ją-stosuje-i-dlaczego-gdzie-łączy-się-fragmenty" class="h_anchor"></a></h3>

<p>
Fragmentacja IP to podział pakietu, gdy jego rozmiar jest większy niż <b>MTU </b>łącza wyjściowego. Zachodzi w dowolnym routerze na trasie i polega na dodaniu do podzielonych pakietów dodatkowych metadanych — identyczny identyfikator, flagę, mówiącą czy jest więcej fragmentów oraz offset, czyli numer pierwszego bajtu w oryginalnym pakiecie oraz flagę DF — don't fragment. <b>MTU</b> jest stosowane, by zredukować opóźnienia w sieci — <a href="https://en.wikipedia.org/wiki/Maximum_transmission_unit#Tradeoffs." title="https://en.wikipedia.org/wiki/Maximum_transmission_unit#Tradeoffs." class="https">https://en.wikipedia.org/wiki/Maximum_transmission_unit#Tradeoffs.</a>
</p>

<p>
Stosuje się ją w routerach na portach wyjściowych.
</p>

<p>
Łączenie fragmentów zachodzi dopiero na komputerze docelowym.
</p>

<p>
<img src="./Wykład_4_--_Routing_(wewnątrz_routera)/pasted_image011.png">
</p>

<br>

<h3>❖ Co to jest MTU? Na czym polega technika wykrywania wartości MTU dla ścieżki?<a id="-co-to-jest-mtu-na-czym-polega-technika-wykrywania-wartości-mtu-dla-ścieżki" class="h_anchor"></a></h3>

<br>

<p>
<b>MTU</b> to <i>maximum transmission unit</i>, czyli największy rozmiar pakietu, jaki jest w stanie przesłać łącze wyjściowe. W przypadku zbyt dużych pakietów można stosować fragmentację, ale jest ona związana z dużym narzutem pamięciowym i czasowym, dlatego lepiej jest wykrywać wartość MTU dla ścieżki.
</p>

<p>
Technika ta polega na wyszukiwaniu minimalnej wartości MTU na ścieżce. Ustalamy rozmiar pakietów na taką wartość, dzięki czemu unikamy fragmentacji — pakiet na pewno zmieści się w każdym routerze. Jak znaleźć takie minimalne MTU? Podobnie do traceroute:<br>
<ol type="1" start="1">
<li>Ustawiamy DF (don't fragment) w nagłówku IP.</li>
<li>Wysyłamy pakiet.</li>
<li>Jeśli w danym routerze pakiet będzie musiał zostać poddany fragmentacji, wtedy router odrzuca ten pakiet i odsyła komunikat ICMP (<i>destination unreachable, can't fragment</i>) z rozmiarem MTU kolejnego łącza na ścieżce.</li>
<li>Zmniejszamy rozmiar pakietu i ponownie wysyłamy pakiet.</li>
</ol>
</p>

<h3>❖ Jak działa szeregowanie pakietów w buforze wyjściowym routera?<a id="-jak-działa-szeregowanie-pakietów-w-buforze-wyjściowym-routera" class="h_anchor"></a></h3>

<br>

<p>
W buforze wyjściowym wyznacza się strumienie — kolejki, w którym umieszczamy pakiety o danym priorytecie. Klasyfikator przesyła pakiety do strumienia o odpowiednim priorytecie, a scheduler wyciąga pakiety ze strumieni i wysyła dalej, zgodnie z ustaloną polityką pierwszeństwa.
</p>

<p>
Możemy szeregować pakiety względem priorytetów strumieni albo cyklicznie (round-robin), gdzie każdy strumień ma tyle samo pakietów
</p>

<p>
<img src="./Wykład_4_--_Routing_(wewnątrz_routera)/pasted_image012.png"><br>
<img src="./Wykład_4_--_Routing_(wewnątrz_routera)/pasted_image013.png">
</p>

<p>
Pakiety powinny mieć stały rozmiar, bo inaczej duze pakiety mogą zajmować dużo czasu, zanim zostaną wysłane, i będą zapychać strumienie.
</p>

<h3>❖ Jakie są różnice pomiędzy nagłówkami IPv4 i IPv6?<a id="-jakie-są-różnice-pomiędzy-nagłówkami-ipv4-i-ipv6" class="h_anchor"></a></h3>

<p>
Różnice między IPv4 i IPv6<br>
<ul>
<li>adresy mają 32, a nie 128 bitów</li>
<li>nagłówki w IPv6 mają stałą długość, nie wymagają fragmentacji, sum kontrolnych i posiadają etykietę strumienia (nie trzeba patrzeć na port)</li>
<li>wszystkie sieci w IPv6 mają maskę <a href="file:///64" title="/64" class="file">/64</a> — 64 bity na adres sieci i 64 na adres hosta</li>
<li>wyjątki to łącza dwupunktowe — maski /127</li>
<li>mniejszy narzut dla routerów w IPv6</li>
<li>IPv6 ma identyfikator strumienia, który ułatwia pracę routerowi (często routery mają regułki związane z zaporą albo z równoważeniem ruchu, jeśli jest identyfikator, to router nie musi zglądać wgłąb pakietu)</li>
</ul>
</p>

<p>
<img src="./Wykład_4_--_Routing_(wewnątrz_routera)/pasted_image015.png">
</p>

<p>
<img src="./Wykład_4_--_Routing_(wewnątrz_routera)/pasted_image014.png">
</p>

<br>

<h3>❖ Zapisz adres IPv6 0321:0000:0000:0123:0000:0000:0000:0001 w najkrótszej możliwej postaci.<a id="-zapisz-adres-ipv6-03210000000001230000000000000001-w-najkrótszej-możliwej-postaci" class="h_anchor"></a></h3>

<br>

<p>
IPv6 0321:0000:0000:0123:0000:0000:0000:0001 można zapisać krócej jako 321:0:0:123::1 
</p>

<p>
<img src="./Wykład_4_--_Routing_(wewnątrz_routera)/pasted_image016.png">
</p>

<h3>❖ Co to jest tunelowanie 6in4?<a id="-co-to-jest-tunelowanie-6in4" class="h_anchor"></a></h3>

<p>
Jest to mechanizm migracji między IPv4 a IPv6. Pakiety IPv6 są w nim wysyłane jako dane pakietów IPv4. Pakiety IPv6 są potem wyłuskiwane z pakietów IPv4 przez <b>brokera tunelu</b>. Jest przydatny, ponieważ najczęściej routery w sieciach domowych i ich okolicach nie rozumieją IPv6, więc nie są w stanie przesłać takiego ruchu sieciowego, ale jądro Internetu już je obsługuje, zatem wystarczy tylko przebić się przez ten problematyczny bufor routerów starej daty.
</p>

<p>
<img src="./Wykład_4_--_Routing_(wewnątrz_routera)/pasted_image017.png">
</p>

<h3>❖ Na czym polega NAT i po co się go stosuje? Jakie są jego zalety i wady?<a id="-na-czym-polega-nat-i-po-co-się-go-stosuje-jakie-są-jego-zalety-i-wady" class="h_anchor"></a></h3>

<p>
<b>NAT</b> (<i>network adress translation) </i>— technika routerów na obchodzenie problemu brakujących adresów IP. W obrębie danej sieci lokalnej wszystkie komputery mają prywatne IP, niewidoczne z zewnątrz. Z punktu widzenia Internetu cała sieć lokalna ma jedno IP — jest jednym komputerem.
</p>

<p>
<img src="./Wykład_4_--_Routing_(wewnątrz_routera)/pasted_image018.png">
</p>

<p>
<b>Działanie</b>:<br>
<img src="./Wykład_4_--_Routing_(wewnątrz_routera)/pasted_image019.png">f
</p>

<p>
<b>Zady:</b><br>
<ul>
<li>rozwiązuje problem braku adresów IP</li>
<li>można zmienić adresy IP wewnątrz sieci bez powiadamiania reszty Internetu</li>
<li>można zmienić ISP pozostawiając adresowanie IP wewnątrz sieci takim, jakie jest</li>
</ul>
</p>

<p>
<b>Walety:</b><br>
<ul>
<li>nieosiągalność komputerów z Internetu (aplikacje P2P)</li>
<li>psuje model warstwowy (router musi modyfikować treść pakietu)</li>
</ul>
</p>

<h3>❖ Jaki stan musi przechowywać router z funkcją NAT?<a id="-jaki-stan-musi-przechowywać-router-z-funkcją-nat" class="h_anchor"></a></h3>


	</div>

	<br />

	<div class='page-footer'>
		<b>Backlinks:</b>

		<a href='../Sieci_Komputerowe_--_Notatki.html'>Sieci Komputerowe -- Notatki</a>

		<br /><br />

			<b>Attachments:</b>
			<table>

			<tr><td><a href='./Wykład_4_--_Routing_(wewnątrz_routera)/pasted_image.png'>pasted_image.png</a></td><td>&nbsp;</td><td>817kb</td></tr>


			<tr><td><a href='./Wykład_4_--_Routing_(wewnątrz_routera)/pasted_image001.png'>pasted_image001.png</a></td><td>&nbsp;</td><td>853kb</td></tr>


			<tr><td><a href='./Wykład_4_--_Routing_(wewnątrz_routera)/pasted_image002.png'>pasted_image002.png</a></td><td>&nbsp;</td><td>377kb</td></tr>


			<tr><td><a href='./Wykład_4_--_Routing_(wewnątrz_routera)/pasted_image003.png'>pasted_image003.png</a></td><td>&nbsp;</td><td>918kb</td></tr>


			<tr><td><a href='./Wykład_4_--_Routing_(wewnątrz_routera)/pasted_image004.png'>pasted_image004.png</a></td><td>&nbsp;</td><td>648kb</td></tr>


			<tr><td><a href='./Wykład_4_--_Routing_(wewnątrz_routera)/pasted_image005.png'>pasted_image005.png</a></td><td>&nbsp;</td><td>648kb</td></tr>


			<tr><td><a href='./Wykład_4_--_Routing_(wewnątrz_routera)/pasted_image006.png'>pasted_image006.png</a></td><td>&nbsp;</td><td>386kb</td></tr>


			<tr><td><a href='./Wykład_4_--_Routing_(wewnątrz_routera)/pasted_image007.png'>pasted_image007.png</a></td><td>&nbsp;</td><td>386kb</td></tr>


			<tr><td><a href='./Wykład_4_--_Routing_(wewnątrz_routera)/pasted_image008.png'>pasted_image008.png</a></td><td>&nbsp;</td><td>787kb</td></tr>


			<tr><td><a href='./Wykład_4_--_Routing_(wewnątrz_routera)/pasted_image009.png'>pasted_image009.png</a></td><td>&nbsp;</td><td>787kb</td></tr>


			<tr><td><a href='./Wykład_4_--_Routing_(wewnątrz_routera)/pasted_image010.png'>pasted_image010.png</a></td><td>&nbsp;</td><td>494kb</td></tr>


			<tr><td><a href='./Wykład_4_--_Routing_(wewnątrz_routera)/pasted_image011.png'>pasted_image011.png</a></td><td>&nbsp;</td><td>570kb</td></tr>


			<tr><td><a href='./Wykład_4_--_Routing_(wewnątrz_routera)/pasted_image012.png'>pasted_image012.png</a></td><td>&nbsp;</td><td>334kb</td></tr>


			<tr><td><a href='./Wykład_4_--_Routing_(wewnątrz_routera)/pasted_image013.png'>pasted_image013.png</a></td><td>&nbsp;</td><td>770kb</td></tr>


			<tr><td><a href='./Wykład_4_--_Routing_(wewnątrz_routera)/pasted_image014.png'>pasted_image014.png</a></td><td>&nbsp;</td><td>226kb</td></tr>


			<tr><td><a href='./Wykład_4_--_Routing_(wewnątrz_routera)/pasted_image015.png'>pasted_image015.png</a></td><td>&nbsp;</td><td>375kb</td></tr>


			<tr><td><a href='./Wykład_4_--_Routing_(wewnątrz_routera)/pasted_image016.png'>pasted_image016.png</a></td><td>&nbsp;</td><td>375kb</td></tr>


			<tr><td><a href='./Wykład_4_--_Routing_(wewnątrz_routera)/pasted_image017.png'>pasted_image017.png</a></td><td>&nbsp;</td><td>1.03Mb</td></tr>


			<tr><td><a href='./Wykład_4_--_Routing_(wewnątrz_routera)/pasted_image018.png'>pasted_image018.png</a></td><td>&nbsp;</td><td>667kb</td></tr>


			<tr><td><a href='./Wykład_4_--_Routing_(wewnątrz_routera)/pasted_image019.png'>pasted_image019.png</a></td><td>&nbsp;</td><td>820kb</td></tr>

			</table>
	</div>

	

</div>

</body>
</html>
